<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="naver-site-verification" content="9b8cccba15d55ed0fa17613723c0a01107faa6a4"/>
    <link rel="canonical" href="https://shlee1353.github.io/2017/11/15/Node-Express-Server/"/>
    
    <title>[노드js] Express 서버 시작하기 | Ryan Lee</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="" />
    
    <meta name="description" content="Express is a minimal and flexible Node.js web application framework that provides a robust set of features to develop web and mobile applications. It facilitates the rapid development of Node based We">
<meta property="og:type" content="article">
<meta property="og:title" content="[노드js] Express 서버 시작하기">
<meta property="og:url" content="https://shlee1353.github.io/2017/11/15/Node-Express-Server/index.html">
<meta property="og:site_name" content="Ryan Lee">
<meta property="og:description" content="Express is a minimal and flexible Node.js web application framework that provides a robust set of features to develop web and mobile applications. It facilitates the rapid development of Node based We">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://shlee1353.github.io/img/node.png">
<meta property="og:updated_time" content="2017-11-29T02:50:47.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[노드js] Express 서버 시작하기">
<meta name="twitter:description" content="Express is a minimal and flexible Node.js web application framework that provides a robust set of features to develop web and mobile applications. It facilitates the rapid development of Node based We">
<meta name="twitter:image" content="https://shlee1353.github.io/img/node.png">
    

    
        <link rel="alternate" href="/" title="Ryan Lee" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-109666025-1', 'auto');
ga('send', 'pageview');

</script>
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/index.html">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    uncategorized
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-Node-Express-Server" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        [노드js] Express 서버 시작하기
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2017/11/15/Node-Express-Server/" class="article-date">
            <time datetime="2017-11-15T05:12:33.000Z" itemprop="datePublished">2017-11-15</time>
        </a>
    </div>

                
            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><strong>Express</strong> is a minimal and flexible Node.js web application framework that provides a robust set of features to develop web and mobile applications. It facilitates the rapid development of Node based Web applications. </p>
<p><strong>tutorial source</strong><br>After cloning this repository, checkout to <strong>feature/express-basic</strong></p>
<h3 id="Installing-Express"><a href="#Installing-Express" class="headerlink" title="Installing Express"></a>Installing Express</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm init // package.json name : express-tutorial</span><br><span class="line"></span><br><span class="line">npm install express --save</span><br><span class="line"></span><br><span class="line">// npm install express-generator -g</span><br><span class="line">// express myproject --ejs</span><br></pre></td></tr></table></figure>
<h3 id="1-간단한-웹서버-작성"><a href="#1-간단한-웹서버-작성" class="headerlink" title="1. 간단한 웹서버 작성"></a>1. 간단한 웹서버 작성</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// basic.server.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">'&lt;h1&gt;hellp express&lt;/h1&gt;'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="2-라우팅"><a href="#2-라우팅" class="headerlink" title="2. 라우팅"></a>2. 라우팅</h3><ul>
<li>HTTP 요청의 메서드와 URL(PATH) 형태에 따라 분기하는 역할</li>
<li>HTTP 메서드로부터 파생<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// route.server.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/a'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">'&lt;a href="/b"&gt;Go to B&lt;/a&gt;'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/b'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">'&lt;a href="/a"&gt;Go to A&lt;/a&gt;'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://localhost:8080/page?name=Ryan</span></span><br><span class="line">app.get(<span class="string">'/page'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">'welcome'</span> + request.query.name);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://localhost:8080/page/Ryan</span></span><br><span class="line">app.get(<span class="string">'/page/:name'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">'welcome'</span> + request.params.name);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-미들웨어"><a href="#3-미들웨어" class="headerlink" title="3. 미들웨어"></a>3. 미들웨어</h3><ul>
<li>http 모듈과 express 모듈의 가장 큰 차이는 미들웨어의 유무</li>
<li>요청에 대한 응답을 완료하기 전까지 요청 중간에서 여러가지 일을 처리</li>
<li>use() 메서드로 미들웨어를 적용</li>
<li>next() 함수를 호출하여 다음 미들웨어로 제어권을 넘김<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// middleware.server.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">'/special'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response, next</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'스페셜 미들웨어'</span>);</span><br><span class="line">	response.send(<span class="string">'special middleware'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">request, response, next</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'미들웨어 1'</span>);</span><br><span class="line">	next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">request, response, next</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'미들웨어 2'</span>);</span><br><span class="line">	response.end(<span class="string">'middleware 1,2'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-static-미들웨어"><a href="#4-static-미들웨어" class="headerlink" title="4. static 미들웨어"></a>4. static 미들웨어</h3><ul>
<li>express 에서 기본 제공하는 미들웨어</li>
<li>이미지, CSS, JS, HTML 파일과 같은 정적 리소스를 제공할 루트 경로를 지정하는 역할<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// static.server.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 기본호출</span></span><br><span class="line">app.use(express.static(__dirname + <span class="string">'/static'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//가상경로 지정</span></span><br><span class="line">app.use(<span class="string">'/public'</span>, express.static(__dirname + <span class="string">'/static'</span>));</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-body-parser-미들웨어"><a href="#5-body-parser-미들웨어" class="headerlink" title="5. body-parser 미들웨어"></a>5. body-parser 미들웨어</h3><ul>
<li>POST 요청시 전달된 데이터를 추출하는 미들웨어</li>
<li>body-parser 미들웨어를 사용하려면 request객체에 body 속성이 부여됨</li>
<li><a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop" target="_blank" rel="external">Postman</a>을 통해 POST 요청 확인 가능함</li>
<li>포스트맨 사용시 <a href="https://gist.github.com/jays1204/703297eb0da1facdc454" target="_blank" rel="external">Content-Type</a>은 application/x-www-form-urlencode를 사용 (key-value&amp;key=value…의 형태로 전송)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser --save</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// static.server.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;));</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/post'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.send(<span class="string">"POST Data:"</span> + request.body.content);</span><br><span class="line">&#125;);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="6-템플릿-엔진"><a href="#6-템플릿-엔진" class="headerlink" title="6. 템플릿 엔진"></a>6. 템플릿 엔진</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ejs --save</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// index.ejs</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=title%</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=message%</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// template.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.set(<span class="string">'views'</span>, <span class="string">'./views'</span>);</span><br><span class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'ejs'</span>);</span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">	response.render(<span class="string">'index'</span>, &#123;<span class="attr">title</span>: <span class="string">'Hello'</span>, <span class="attr">message</span>: <span class="string">'Express!'</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="7-todoapp-API"><a href="#7-todoapp-API" class="headerlink" title="7. todoapp API"></a>7. todoapp API</h3><p>After cloning this repository, checkout to <strong>feature/express-todoapp</strong><br><strong>7-1. todo.server.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Express 모듈 추출</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// body-parser 미들웨어 추출</span></span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Express 서버 객체 생성</span></span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 정적 리소스 경로 지정</span></span><br><span class="line">app.use(express.static(__dirname + <span class="string">'/static'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// body-parser 미들웨어 적용</span></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 라우팅</span></span><br><span class="line">app.use(<span class="string">'/'</span>, <span class="built_in">require</span>(<span class="string">'./todo.router.js'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 서버 구동</span></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>To serve static files such as images, CSS files, and JavaScript files, use the <strong>express.static</strong> built-in middleware function in Express. You can load the files that are in the public directory. Express looks up the files relative to the static directory, so the name of the static directory is not part of the URL. <strong>__dirname</strong> is the directory name of the current module. It’s safer to use the absolute path of the directory that you want to serve:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">'public'</span>))</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//localhost:3000/images/kitten.jpg</span></span><br><span class="line">http:<span class="comment">//localhost:3000/css/style.css</span></span><br><span class="line">http:<span class="comment">//localhost:3000/js/app.js</span></span><br><span class="line">http:<span class="comment">//localhost:3000/images/bg.png</span></span><br><span class="line">http:<span class="comment">//localhost:3000/hello.html</span></span><br></pre></td></tr></table></figure></p>
<p>To use multiple static assets directories, call the express.static middleware function multiple times:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">'public'</span>))</span><br><span class="line">app.use(express.static(<span class="string">'files'</span>))</span><br></pre></td></tr></table></figure></p>
<p><strong>7-2. todo.router.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 데이터를 저장할 디렉토리</span></span><br><span class="line"><span class="keyword">var</span> dataPath = __dirname + <span class="string">'/data/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO 목록 조회</span></span><br><span class="line">router.get(<span class="string">'/todos'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> files = fs.readdirSync(dataPath);</span><br><span class="line">	<span class="comment">// [ '1499652647873.json', '1499652721429.json', '1499652725947.json', '1499652729161.json', '1499652734901.json' ]</span></span><br><span class="line">	<span class="keyword">var</span> todos = [];</span><br><span class="line">	<span class="comment">// [ &#123; id: 1499652647873, content: 'To do list 실습 테스트' &#125;,</span></span><br><span class="line">	<span class="comment">// &#123; id: 1499652721429, content: '등록 기능 개발' &#125;,</span></span><br><span class="line">	<span class="comment">// &#123; id: 1499652725947, content: '목록 조회 기능 개발' &#125;,</span></span><br><span class="line">	<span class="comment">// &#123; id: 1499652729161, content: '삭제 기능 개발' &#125;,</span></span><br><span class="line">	<span class="comment">// &#123; id: 1499652734901, content: '완성!' &#125; ]</span></span><br><span class="line"></span><br><span class="line">	files.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">file</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> jsonData = <span class="built_in">JSON</span>.parse(fs.readFileSync(dataPath + file, <span class="string">'utf8'</span>));</span><br><span class="line">		todos.push(jsonData);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	res.send(&#123;</span><br><span class="line">		result: <span class="string">'success'</span>,</span><br><span class="line">		data: todos</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO 추가</span></span><br><span class="line">router.post(<span class="string">'/todos'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> id = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">	<span class="comment">// 1500880894981</span></span><br><span class="line">	<span class="keyword">var</span> filePath = dataPath + id + <span class="string">'.json'</span>;</span><br><span class="line">	<span class="comment">// .../data/1500880942949.json</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> jsonData = &#123;</span><br><span class="line">		id:id,</span><br><span class="line">		content:req.body.content</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// &#123; id: 1500880894981, content: 'test' &#125;</span></span><br><span class="line"></span><br><span class="line">	fs.writeFileSync(filePath, <span class="built_in">JSON</span>.stringify(jsonData), <span class="string">'utf8'</span>);</span><br><span class="line"></span><br><span class="line">	res.send(&#123;</span><br><span class="line">		result: <span class="string">'success'</span>,</span><br><span class="line">		data: jsonData</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO 삭제</span></span><br><span class="line">router.delete(<span class="regexp">/todos\/(\d+)/</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">	<span class="comment">// \d is a digit (a character in the range 0-9), and + means 1 or more times. So, \d+ is 1 or more digits.</span></span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		fs.unlinkSync(dataPath + req.params[<span class="number">0</span>] + <span class="string">'.json'</span>);</span><br><span class="line">		res.send(&#123;</span><br><span class="line">			result: <span class="string">'success'</span></span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">		res.send(&#123;</span><br><span class="line">			result: <span class="string">'failed'</span>,</span><br><span class="line">			error: e.syscall + <span class="string">' error'</span></span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure></p>
<p><strong>express.Router</strong><br>모듈식 마운팅이 가능한 핸들러를 작성할 수 있음. 라우트를 모듈로 작성하고 미들웨어함수 로드 및 라우팅을 정의한 후 기본앱의 한 경로에 라우터 모듈을 마운트합니다.</p>
<p>The Node.js file system module allow you to work with the file system on your computer. To include the File System module, use the require() method:</p>
<ul>
<li><p>Read Files</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dataPath = __dirname;</span><br><span class="line"></span><br><span class="line"><span class="comment">// readFile</span></span><br><span class="line">fs.readFile(dataPath + <span class="string">'/index.html'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err,data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// readFileSync</span></span><br><span class="line"><span class="keyword">var</span> contensts = fs.readFileSync(dataPath + <span class="string">'/index.html'</span>).toString();</span><br><span class="line"><span class="built_in">console</span>.log(contensts);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create Files</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dataPath = __dirname;</span><br><span class="line"><span class="keyword">var</span> filePath = dataPath + <span class="string">'/data/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello content!Hello content!Hello content!Hello content!</span></span><br><span class="line">fs.appendFile(filePath + <span class="string">'mynewfile1.txt'</span>, <span class="string">'Hello content!'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Saved!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello content!</span></span><br><span class="line">fs.writeFile(filePath + <span class="string">'mynewfile2.txt'</span>, <span class="string">'Hello content!'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Saved!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'web server started'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Delete Files</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dataPath = __dirname;</span><br><span class="line"><span class="keyword">var</span> filePath = dataPath + <span class="string">'/data/'</span></span><br><span class="line"></span><br><span class="line">fs.unlink(filePath + <span class="string">'mynewfile2.txt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'File deleted!'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>7-3. app.js</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> todoModel = (<span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">_api</span>(<span class="params">url, method, data</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> deferred = $.Deferred();</span><br><span class="line">		</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">			url: url, </span><br><span class="line">			method: method, </span><br><span class="line">			data: data, </span><br><span class="line">			success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(res.result === <span class="string">'success'</span>)&#123;</span><br><span class="line">					deferred.resolve(res);</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					deferred.reject(res);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			error: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">				<span class="built_in">console</span>.warn(<span class="string">'API 호출 실패 :'</span>, url, err);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> deferred.promise();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		getTodos : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _api(<span class="string">'/todos'</span>, <span class="string">'get'</span>);</span><br><span class="line">		&#125;, <span class="comment">// (9)</span></span><br><span class="line"></span><br><span class="line">		addTodo : <span class="function"><span class="keyword">function</span>(<span class="params">content</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _api(<span class="string">'/todos'</span>, <span class="string">'post'</span>, &#123;<span class="attr">content</span>:content&#125;);</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		deleteTodo : <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> _api(<span class="string">'/todos/'</span> + id, <span class="string">'delete'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;)(jQuery);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> todoView = (<span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> self;</span><br><span class="line">	<span class="keyword">var</span> $els = &#123;&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> _prependTodo = <span class="function"><span class="keyword">function</span>(<span class="params">id, content</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> $newTodo = $els.todoItemTemplate.clone();</span><br><span class="line"></span><br><span class="line">		$newTodo</span><br><span class="line">			.attr(<span class="string">'data-todoid'</span>, id)</span><br><span class="line">			.find(<span class="string">'._todoContent'</span>)</span><br><span class="line">			.text(content);</span><br><span class="line"></span><br><span class="line">		$els.todoList.prepend($newTodo);</span><br><span class="line">	&#125;; <span class="comment">// (15)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> _onSubmit = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> content = $els.todoInput.val().trim();</span><br><span class="line"></span><br><span class="line">		$els.todoInput</span><br><span class="line">			.val(<span class="string">''</span>)</span><br><span class="line">			.focus();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(content.length)&#123;</span><br><span class="line">			$(self).trigger(<span class="string">'addTodo'</span>, [content]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		e.preventDefault();</span><br><span class="line">	&#125;; <span class="comment">// (12)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> _onClickDeleteBtn = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> todoId = $(e.currentTarget).closest(<span class="string">'._todoItem'</span>).attr(<span class="string">'data-todoid'</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(confirm(<span class="string">'삭제하시겠습니까?'</span>))&#123;</span><br><span class="line">			$(self).trigger(<span class="string">'deleteTodo'</span>, [todoId]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		init : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			self = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">this</span>.cacheElements();</span><br><span class="line">			<span class="keyword">this</span>.bindEvents();</span><br><span class="line">		&#125;, <span class="comment">// (3)</span></span><br><span class="line"></span><br><span class="line">		cacheElements : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			$els.todoForm = $(<span class="string">'._todoInputForm'</span>);</span><br><span class="line">			$els.todoInput = $(<span class="string">'._todoInput'</span>);</span><br><span class="line">			$els.todoItemTemplate = $(<span class="string">'._todoItem'</span>).detach();</span><br><span class="line">			$els.todoList = $(<span class="string">'._todoList'</span>);</span><br><span class="line">			</span><br><span class="line">			$els.todoList</span><br><span class="line">				.empty()</span><br><span class="line">				.show();</span><br><span class="line">		&#125;, <span class="comment">// (4), (5)</span></span><br><span class="line"></span><br><span class="line">		bindEvents : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			$els.todoForm.on(<span class="string">'submit'</span>, _onSubmit);</span><br><span class="line">			$els.todoList.on(<span class="string">'click'</span>, <span class="string">'._deleteBtn'</span>, _onClickDeleteBtn);</span><br><span class="line">		&#125;, <span class="comment">// (6), (11)</span></span><br><span class="line"></span><br><span class="line">		renderTodos : <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">			$els.todoList.empty();</span><br><span class="line"></span><br><span class="line">			$(data).each(<span class="function"><span class="keyword">function</span>(<span class="params">i, item</span>)</span>&#123;</span><br><span class="line">				_prependTodo(item.id, item.content);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;, <span class="comment">// (10)</span></span><br><span class="line"></span><br><span class="line">		deleteTodo : <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">			$els.todoList.find(<span class="string">'._todoItem[data-todoid='</span>+id+<span class="string">']'</span>).remove();</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		prependTodo : <span class="function"><span class="keyword">function</span>(<span class="params">id, content</span>)</span>&#123;</span><br><span class="line">			_prependTodo(id, content);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)(jQuery);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> todoController = (<span class="function"><span class="keyword">function</span>(<span class="params">$, model, view</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> self;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> _onAddTodo = <span class="function"><span class="keyword">function</span>(<span class="params">e, content</span>)</span>&#123;</span><br><span class="line">		model</span><br><span class="line">			.addTodo(content)</span><br><span class="line">			.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">				view.prependTodo(res.data.id, res.data.content);</span><br><span class="line">			&#125;);					</span><br><span class="line">	&#125;; <span class="comment">// (14)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> _onDeleteTodo = <span class="function"><span class="keyword">function</span>(<span class="params">e, id</span>)</span>&#123;</span><br><span class="line">		model</span><br><span class="line">			.deleteTodo(id)</span><br><span class="line">			.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">				view.deleteTodo(id);</span><br><span class="line">			&#125;);	</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		init : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			self = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">			view.init();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">this</span>.bindEvents();</span><br><span class="line">			<span class="keyword">this</span>.renderTodos();</span><br><span class="line">		&#125;, <span class="comment">// (2)</span></span><br><span class="line">               <span class="comment">// 뷰에서 발생한 특정 이벤트에 대해 특정 모델값을 업데이트 한 후 다시 뷰로 전달하는 바인딩</span></span><br><span class="line">		bindEvents : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">var</span> $view = $(view);</span><br><span class="line"></span><br><span class="line">			$view</span><br><span class="line">				.on(<span class="string">'addTodo'</span>, _onAddTodo)</span><br><span class="line">				.on(<span class="string">'deleteTodo'</span>, _onDeleteTodo);</span><br><span class="line">		&#125;, <span class="comment">// (7), (13)</span></span><br><span class="line"></span><br><span class="line">		renderTodos : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			model</span><br><span class="line">				.getTodos()</span><br><span class="line">				.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">					view.renderTodos(res.data);</span><br><span class="line">				&#125;);</span><br><span class="line">		&#125; <span class="comment">// (8)</span></span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;)(jQuery, todoModel, todoView).init(); <span class="comment">// (1)</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Initial Setting</strong></p>
<ol>
<li>todoController.init() 실행</li>
<li>view.init(), bindEvents(), renderTodos() 실행</li>
<li>cacheElements(), bindEvents() 실행</li>
<li>The <strong>.detach()</strong> method is the same as .remove(), except that .detach() keeps all jQuery data associated with the removed elements. This method is useful when removed elements are to be reinserted into the DOM at a later time.</li>
<li>Object {todoForm: n.fn.init(1), todoInput: n.fn.init(1), todoItemTemplate: n.fn.init(1), todoList: n.fn.init(1)}</li>
<li>bindEvents() 실행 ‘submit’, ‘click’ 이벤트 바인딩</li>
<li>jQuery 메소드를 사용하기 위해 view 객체를 $() 적용후 ‘addTodo’, ‘deleteTodo’ 이벤트 바인딩</li>
<li>mode.getTodos() 실행후 res 값을 받아, view.renderTodos(res.data)로 전달. res는 Object {result: “success”, data: Array(6)}</li>
<li><p>res값은 _api(‘/todos’, ‘get’)를 통해 가져온 데이터 값임. 이때 비동기 프로그래밍을 위해 var deferred = $.Deferred() 를 사용함. $.Deferred()로 deferred 객체를 만들고, 성공했을 때에는 resolve, 실패했을 때에는 reject 메소드를 호출하면 resolve는 done으로, reject는 fail로 연결됨. done이나 fail로 구분하지 않고 한 번에 처리하려면 then 메소드 사용. longAndComplicatedFunction 함수에서 deferred.promise()를 return 해야함.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> longAndComplicatedFunction = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> deferred = $.Deferred();</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">// 완료되려면 50초가 걸리는 매우 복잡한 비동기 코드</span></span><br><span class="line">		deferred.resolve(<span class="string">'성공'</span>);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    	       deferred.reject(err);</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">return</span> deferred.promise();</span><br><span class="line">&#125;;</span><br><span class="line">longAndComplicatedFunction().done(<span class="function"><span class="keyword">function</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(message);</span><br><span class="line">&#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;).always(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'완료!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'다음 행동'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>renderTodos() 실행. 기존에 있던 리스트($els.todoList.empty())를 삭제 후 전달받은 값을 이용해 each 구문실행. ‘data-todoid’ 값과 컨텐츠를 담고있는 아이템을 생성한후 리스트에 추가한다 ($els.todoList.prepend($newTodo))</p>
</li>
</ol>
<p><strong>add item</strong></p>
<ol>
<li>submit 이벤트 발생 후, _onSubmit 함수 실행</li>
<li><p>input의 값을 content에 담고, 초기화. content 값이 있을 경우 $(self).trigger(‘addTodo’, [content]) 실행. addTodo 는 커스텀 이벤트로 .on 으로 연결된 함수를 실행</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#foo"</span> ).on( <span class="string">"custom"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> event, param1, param2 </span>) </span>&#123;</span><br><span class="line">  alert( param1 + <span class="string">"\n"</span> + param2 );</span><br><span class="line">&#125;);</span><br><span class="line">$( <span class="string">"#foo"</span>).trigger( <span class="string">"custom"</span>, [ <span class="string">"Custom"</span>, <span class="string">"Event"</span> ] );</span><br></pre></td></tr></table></figure>
</li>
<li><p>$view.on(‘addTodo’, _onAddTodo) 실행. </p>
</li>
<li>입력한 내용은 <a href="https://kevinchisholm.gitbooks.io/handling-post-requests-with-express-and-node-js/content/" target="_blank" rel="external">POST data</a>를 통해 Node.js 웹서버로 전달되며, 전달된 값은 fs.writeFileSync()를 통해 시스템에 저장되며, 생성된 id와 content는 클라이언트 쪽으로 반환됩니다. </li>
<li>view.prependTodo()의 인자로 전달 되어 _prependTodo()를 실행합니다.</li>
</ol>
<p>참고</p>
<ul>
<li><a href="https://zellwk.com/blog/crud-express-mongodb/" target="_blank" rel="external">https://zellwk.com/blog/crud-express-mongodb/</a></li>
<li><a href="https://mlab.com/" target="_blank" rel="external">https://mlab.com/</a></li>
</ul>

        </div>
        <footer class="article-footer">
            



    <a data-url="https://shlee1353.github.io/2017/11/15/Node-Express-Server/" data-id="cjatfp4t500072ydyjr9iynb9" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>follow:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="/" target="_blank">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="google-plus" href="/" target="_blank">
                        <i class="icon fa fa-google-plus"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://shlee1353.github.io/" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/11/15/Angular-Lifecycle-Hooks/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            [앵귤러] 라이프사이클 이애하기
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2017/11/15/JS-Data-Management/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">[자바스크립트] 데이터 관리 object, array</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/12/05/JS-Basic-Guide/" class="thumbnail">
    
    
        <span style="background-image:url(https://shlee1353.github.io/img/javascript.png)" alt="[자바스크립트] 기본 가이드 (JavaScript Guide)" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/12/05/JS-Basic-Guide/" class="title">[자바스크립트] 기본 가이드 (JavaScript Guide)</a></p>
                            <p class="item-date"><time datetime="2017-12-05T09:38:45.000Z" itemprop="datePublished">2017-12-05</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/27/JS-Practical-Design-Patterns/" class="thumbnail">
    
    
        <span style="background-image:url(https://shlee1353.github.io/img/javascript.png)" alt="[자바스크립트] 실무 디자인 패턴 익히기" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/11/27/JS-Practical-Design-Patterns/" class="title">[자바스크립트] 실무 디자인 패턴 익히기</a></p>
                            <p class="item-date"><time datetime="2017-11-27T08:22:29.000Z" itemprop="datePublished">2017-11-27</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/21/MongoDB-Quick-Guide/" class="thumbnail">
    
    
        <span style="background-image:url(https://sophosnews.files.wordpress.com/2017/01/mongodb.png?w=780&h=408&crop=1)" alt="[몽고DB] 간략 사용 설명서" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/11/21/MongoDB-Quick-Guide/" class="title">[몽고DB] 간략 사용 설명서</a></p>
                            <p class="item-date"><time datetime="2017-11-21T05:35:17.000Z" itemprop="datePublished">2017-11-21</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/15/JS-Understanding-the-this-Keyword/" class="thumbnail">
    
    
        <span style="background-image:url(https://shlee1353.github.io/img/javascript.png)" alt="[자바스크립트] &#39;this&#39; 키워드 이해하기" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/11/15/JS-Understanding-the-this-Keyword/" class="title">[자바스크립트] &#39;this&#39; 키워드 이해하기</a></p>
                            <p class="item-date"><time datetime="2017-11-15T10:21:29.000Z" itemprop="datePublished">2017-11-15</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/11/15/Vue-Quick-Start/" class="thumbnail">
    
    
        <span style="background-image:url(https://return-true.com/wp-content/uploads/2016/02/starting-out-with-vuejs.jpg)" alt="[Vue] 빠르게 훑어보기" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2017/11/15/Vue-Quick-Start/" class="title">[Vue] 빠르게 훑어보기</a></p>
                            <p class="item-date"><time datetime="2017-11-15T07:46:59.000Z" itemprop="datePublished">2017-11-15</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">9</span></li></ul>
        </div>
    </div>


            
                

            
                

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2017 Ryan Lee</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'hexo-theme-hueman';
    
    
    var disqus_url = 'https://shlee1353.github.io/2017/11/15/Node-Express-Server/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
